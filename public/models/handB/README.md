# คู่มือการสร้างโมเดล Hand B - สำหรับทีม No-Code

**Person 2: คุณรับผิดชอบโมเดล Hand B**  
คู่มือนี้จะพาคุณไปตั้งแต่การสร้างโมเดลจนใช้งานได้จริงในระบบ

## คำที่คุณต้องสร้างโมเดลให้จดจำ (9 คำ)

| ลำดับ | คำ | ลักษณะท่าทาง | จำนวนรูปที่แนะนำ |
|-------|-----|--------------|-----------------|
| 1 | **ขอบคุณ** | มือขวาแตะที่หน้าผาก แล้วเหวี่ยงออกมา | 50-60 รูป |
| 2 | **ไม่เป็นไร** | มือโบกซ้ายขวา เหมือนบอกไม่เป็นไร | 50-60 รูป |
| 3 | **สบายดี** | มือทั้งสองข้างชูนิ้วโป้ง | 50-60 รูป |
| 4 | **โชคดี** | มือปิดกำปั้น ชูขึ้นเหนือศีรษะ | 50-60 รูป |
| 5 | **เก่ง** | มือขวาชูนิ้วโป้ง | 50-60 รูป |
| 6 | **อิ่ม** | มือถูท้อง เป็นวงกลม | 50-60 รูป |
| 7 | **หิว** | มือแตะท้อง แสดงอาการหิว | 50-60 รูป |
| 8 | **เศร้า** | มือปิดหน้า หรือเช็ดน้ำตา | 50-60 รูป |
| 9 | **idle** | ท่านิ่งพื้นฐาน มือห้อยธรรมชาติ | **100-120 รูป** สำคัญมาก |

**หมายเหตุ:** idle = สถานะปกติ ไม่ได้ทำท่าใดๆ ให้ถ่ายรูปมือห้อย หรือวางบนโต๊ะ

## การนำโมเดลมาใช้ในโปรเจค

### ไฟล์โมเดลที่ต้องมี (จาก Teachable Machine)
```
ไฟล์ที่ Export ได้จาก Teachable Machine:
├── model.json          ← โครงสร้างโมเดล Neural Network
├── metadata.json       ← ชื่อคลาสและข้อมูล config
└── weights.bin         ← น้ำหนักโมเดล (ไฟล์ขนาดใหญ่)
```

### Path ที่ต้องวางไฟล์ในโปรเจค
```
thai-handmate/
└── public/
    └── models/
        └── handB/                    ← โฟลเดอร์สำหรับ Person 2
            ├── model.json            ← วางที่นี่
            ├── metadata.json         ← วางที่นี่
            ├── weights.bin           ← วางที่นี่
            ├── README.md             ← คู่มือนี้
            └── handB_test.ipynb      ← ไฟล์ทดสอบ
```

### ชื่อไฟล์ที่ต้องใช้ (ห้ามเปลี่ยน)
- **model.json** - เก็บโครงสร้าง Neural Network
- **metadata.json** - เก็บชื่อคลาสและ config
- **weights.bin** - เก็บน้ำหนักโมเดล (อาจมีหลายไฟล์)

**หมายเหตุ**: ชื่อไฟล์จะถูกกำหนดโดย Teachable Machine อัตโนมัติ ห้ามเปลี่ยนชื่อ

### การตรวจสอบไฟล์ metadata.json
เปิดไฟล์ `metadata.json` และตรวจสอบชื่อคลาส:
```json
{
  "labels": [
    "ขอบคุณ",      ← ต้องตรงกับที่ train
    "ไม่เป็นไร", 
    "สบายดี",
    "โชคดี",
    "เก่ง",
    "อิ่ม",
    "หิว", 
    "เศร้า",
    "idle"         ← สำคัญมาก!
  ],
  "imageWidth": 224,
  "imageHeight": 224,
  "imageChannels": 3
}
```

### การปรับแต่งโค้ดในโปรเจค

**ไฟล์ที่ต้องแก้ไข**: `src/lib/config.js`

```javascript
// อัพเดทการตั้งค่าโมเดล Hand B
export const CONFIG = {
  models: {
    handB: {
      modelUrl: '/models/handB/model.json',
      labels: [
        'ขอบคุณ', 'ไม่เป็นไร', 'สบายดี', 'โชคดี', 'เก่ง', 
        'อิ่ม', 'หิว', 'เศร้า', 'idle'
      ],
      threshold: 0.7,    ← ปรับค่าความแม่นยำ (0.5-0.9)
      inputSize: 224     ← ขนาดรูปที่ป้อนเข้า
    }
  }
}
```

**ไฟล์ที่ต้องแก้ไข**: `src/lib/tm.js`

```javascript
// ปรับฟังก์ชันโหลดโมเดล Hand B
export async function loadHandBModel() {
  const modelUrl = '/models/handB/model.json';
  
  try {
    // โหลดโมเดลจาก path ที่กำหนด
    const model = await tmImage.load(modelUrl);
    console.log('✅ โหลดโมเดล Hand B สำเร็จ');
    return model;
  } catch (error) {
    console.error('❌ โหลดโมเดล Hand B ไม่สำเร็จ:', error);
    throw error;
  }
}

// ปรับฟังก์ชันทำนาย
export async function predictHandB(model, imageElement) {
  const predictions = await model.predict(imageElement);
  
  // กรองผลลัพธ์ที่มีความมั่นใจต่ำกว่า threshold
  const threshold = 0.7;
  const validPredictions = predictions.filter(p => p.probability > threshold);
  
  return validPredictions;
}
```

### การตรวจสอบความถูกต้อง

1. **ตรวจสอบไฟล์โมเดล**: ใช้ `handB_test.ipynb`
2. **ตรวจสอบ config**: เปิด Developer Tools (F12) ดู Console
3. **ทดสอบการทำนาย**: ลองท่าภาษามือต่างๆ
4. **ปรับ threshold**: หากผลลัพธ์ไม่แม่นยำ

**เป้าหมาย**: ความแม่นยำ > 85% สำหรับทุกท่าภาษามือ

### ขั้นตอนที่ 1: เข้าเว็บไซต์ Teachable Machine

1. เปิดเว็บเบราว์เซอร์ (Chrome แนะนำ)
2. ไปที่ <https://teachablemachine.withgoogle.com/train/image>
3. คลิก **"Get Started"**
4. เลือก **"Image Project"**

### ขั้นตอนที่ 2: สร้างคลาส (Classes)

1. คุณจะเห็น **"Class 1"** อยู่แล้ว → เปลี่ยนชื่อเป็น **"ขอบคุณ"**
2. คลิก **"+ Add a class"** เพื่อเพิ่มคลาสใหม่
3. สร้างครบ 9 คลาสตามตารางข้างบน
4. ตั้งชื่อให้ตรงกับคำในตาราง

### ขั้นตอนที่ 3: ถ่ายรูปสำหรับแต่ละคลาส 📸

**สำหรับทุกคำ (ยกเว้น idle):**

1. คลิกที่คลาสที่ต้องการ เช่น **"ขอบคุณ"**
2. คลิก **"Hold to Record"**
3. ทำท่าภาษามือ **ขอบคุณ** (มือแตะหน้าผากแล้วเหวี่ยงออก)
4. กดค้างปุ่มเพื่อถ่ายรูปต่อเนื่อง
5. ถ่ายในมุมมองต่างๆ:
   - มือซ้าย-มือขวา
   - ใกล้-ไกลกล้อง
   - แสงสว่าง-แสงมืด
   - พื้นหลังต่างๆ
6. เป้าหมาย: **50-60 รูปต่อคำ**

**สำหรับ "idle" (พิเศษ):**

1. ถ่ายรูปมือในสถานะปกติ
2. มือห้อยธรรมชาติ
3. มือวางบนโต๊ะ
4. มือพับอยู่ด้านข้าง
5. **เป้าหมาย: 100-120 รูป** (มากกว่าคำอื่นๆ)

### ขั้นตอนที่ 4: ตั้งค่าการ Train

1. คลิกแท็บ **"Training"**
2. คลิก **"Advanced"** เพื่อตั้งค่าขั้นสูง
3. ตั้งค่าดังนี้:

```text
Epochs: 100
Batch size: 32  
Learning rate: 0.001
```

4. คลิก **"Train Model"**
5. รอประมาณ 3-5 นาที

### ขั้นตอนที่ 5: ทดสอบโมเดล

1. ไปแท็บ **"Preview"**
2. ทำท่าภาษามือต่างๆ ดูว่าโมเดลจดจำได้หรือไม่
3. ตัวเลข confidence ควรสูงกว่า **0.60** (60%)
4. หากผลไม่ดี → กลับไปเพิ่มรูปในแท็บ "Training"

### ขั้นตอนที่ 6: Export โมเดล

1. ไปแท็บ **"Export"**
2. เลือก **"Tensorflow.js"**
3. เลือก **"Download"** (ไม่ใช่ Hosted Link)
4. คลิก **"Download my model"**
5. จะได้ไฟล์ zip → แตกไฟล์

---

## 📁 ไฟล์ที่ได้หลังแตก Zip

หลังแตกไฟล์ คุณจะได้:

```text
📁 ชื่อโฟลเดอร์ที่ดาวน์โหลด/
├── 📄 model.json          ← โครงสร้างโมเดล
├── 📄 metadata.json       ← ชื่อคลาสทั้งหมด  
├── 📄 weights.bin         ← น้ำหนักโมเดล (อาจมีหลายไฟล์)
└── 📄 ...
```

## 🔧 วิธีนำมาใส่ในโปรเจค

### ขั้นตอนที่ 1: คัดลอกไฟล์

1. เปิดโฟลเดอร์โปรเจค thai-handmate
2. ไปที่ `public/models/handB/`
3. **คัดลอก 3 ไฟล์นี้เข้าไป:**
   - model.json
   - metadata.json
   - weights.bin (หรือไฟล์ .bin ทั้งหมด)

### ขั้นตอนที่ 2: ตรวจสอบชื่อคลาส

1. เปิดไฟล์ `metadata.json`
2. ตรวจสอบว่าชื่อคลาสถูกต้องหรือไม่:

```json
{
  "labels": [
    {"className": "ขอบคุณ"},
    {"className": "ไม่เป็นไร"},
    {"className": "สบายดี"},
    // ... ต้องครบ 9 คลาส
    {"className": "idle"}
  ]
}
```

### ขั้นตอนที่ 3: ทดสอบกับ Jupyter Notebook

1. เปิดไฟล์ `handB_test.ipynb`
2. รันทุกเซลล์ตามลำดับ
3. ทดสอบการทำนาย
4. ตรวจสอบว่า confidence > 0.60

### ขั้นตอนที่ 4: ทดสอบใน Frontend

1. เปิด Terminal ในโปรเจค
2. รันคำสั่ง:

```bash
npm run dev
```

3. เปิดเว็บ <http://localhost:5173>
4. ทดสอบท่าภาษามือผ่านกล้อง

---

## 🎯 เป้าหมายความสำเร็จ

**โมเดลใช้งานได้ดีเมื่อ:**

- ✅ Confidence สูงกว่า 60% สำหรับท่าที่ถูกต้อง
- ✅ แยกแยะระหว่างคำต่างๆ ได้ชัดเจน
- ✅ จดจำ "idle" ได้เมื่อไม่ได้ทำท่าใดๆ
- ✅ ทำงานได้ทั้งมือซ้ายและมือขวา

**หากผลไม่ดี:**

- 🔄 เพิ่มรูปในคลาสที่มีปัญหา
- 🔄 ถ่ายรูปในสภาวะแสงต่างๆ
- 🔄 เพิ่มรูป "idle" ให้มากขึ้น
- 🔄 Train โมเดลใหม่ด้วย Epochs สูงขึ้น

---

## 📞 การติดต่อทีม

**มีปัญหา?** ติดต่อ:

- Person 1: ดูแล Hand A Model
- Person 3: ดูแลระบบ Frontend
- Person 4: ดูแลระบบ Backend
- หรือถามในกลุ่มทีม

**ไฟล์ทดสอบ:** `handB_test.ipynb` - ใช้ทดสอบโมเดลก่อนใส่ระบบจริง